{"version":3,"sources":["https://deno.land/std@0.97.0/encoding/base64.ts","file:///C:/work/flw/src/decoder.ts","file:///C:/work/flw/src/flowers.ts","file:///C:/work/flw/src/utils.ts","file:///C:/work/flw/src/editor/propertyControls.ts","file:///C:/work/flw/src/editor/actionCompiler.ts","file:///C:/work/flw/src/encoder.ts","file:///C:/work/flw/src/editor.ts"],"sourcesContent":["// Copyright 2018-2021 the Deno authors. All rights reserved. MIT license.\n\n// deno-fmt-ignore\nconst base64abc = [\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"I\", \"J\", \"K\", \"L\", \n  \"M\", \"N\", \"O\", \"P\", \"Q\", \"R\", \"S\", \"T\", \"U\", \"V\", \"W\", \"X\", \"Y\", \"Z\", \"a\", \n  \"b\", \"c\", \"d\", \"e\", \"f\", \"g\", \"h\", \"i\", \"j\", \"k\", \"l\", \"m\", \"n\", \"o\", \"p\", \n  \"q\", \"r\", \"s\", \"t\", \"u\", \"v\", \"w\", \"x\", \"y\", \"z\", \"0\", \"1\", \"2\", \"3\", \"4\", \n  \"5\", \"6\", \"7\", \"8\", \"9\", \"+\", \"/\"];\n\n/**\n * CREDIT: https://gist.github.com/enepomnyaschih/72c423f727d395eeaa09697058238727\n * Encodes a given Uint8Array, ArrayBuffer or string into RFC4648 base64 representation\n * @param data\n */\nexport function encode(data: ArrayBuffer | string): string {\n  const uint8 = typeof data === \"string\"\n    ? new TextEncoder().encode(data)\n    : data instanceof Uint8Array\n    ? data\n    : new Uint8Array(data);\n  let result = \"\",\n    i;\n  const l = uint8.length;\n  for (i = 2; i < l; i += 3) {\n    result += base64abc[uint8[i - 2] >> 2];\n    result += base64abc[((uint8[i - 2] & 0x03) << 4) | (uint8[i - 1] >> 4)];\n    result += base64abc[((uint8[i - 1] & 0x0f) << 2) | (uint8[i] >> 6)];\n    result += base64abc[uint8[i] & 0x3f];\n  }\n  if (i === l + 1) {\n    // 1 octet yet to write\n    result += base64abc[uint8[i - 2] >> 2];\n    result += base64abc[(uint8[i - 2] & 0x03) << 4];\n    result += \"==\";\n  }\n  if (i === l) {\n    // 2 octets yet to write\n    result += base64abc[uint8[i - 2] >> 2];\n    result += base64abc[((uint8[i - 2] & 0x03) << 4) | (uint8[i - 1] >> 4)];\n    result += base64abc[(uint8[i - 1] & 0x0f) << 2];\n    result += \"=\";\n  }\n  return result;\n}\n\n/**\n * Decodes a given RFC4648 base64 encoded string\n * @param b64\n */\nexport function decode(b64: string): Uint8Array {\n  const binString = atob(b64);\n  const size = binString.length;\n  const bytes = new Uint8Array(size);\n  for (let i = 0; i < size; i++) {\n    bytes[i] = binString.charCodeAt(i);\n  }\n  return bytes;\n}\n","import {\r\n    decode as decodeBase64,\r\n  } from \"https://deno.land/std@0.97.0/encoding/base64.ts\";\r\n\r\n\r\nexport class Decoder {\r\n    private buf:Uint8Array\r\n    private dv:DataView\r\n    private offset = 0\r\n\r\n    constructor(data:string) {\r\n        const changes:any = { \"-\": \"+\", \"_\": \"/\", \".\": \"=\" } // replaces some urlencode safe chars to base64 chars\r\n        data = data.replace(/\\-|\\_|\\./g, match => changes[match])\r\n        this.buf = decodeBase64(data)\r\n        this.dv = new DataView(this.buf.buffer, this.buf.byteOffset)\r\n    }\r\n\r\n    readVLI() {\r\n        // see: https://en.wikipedia.org/wiki/LEB128\r\n        let b = 0\r\n        var shift = 0     // Bit shift for next read in output\r\n        var num = 0\r\n        do {\r\n            b = this.dv.getUint8(this.offset++)\r\n            num = num | ((b & 0x7f) << shift) // least signifigant 7 bits first, ms7bits last\r\n    \r\n            shift += 7\r\n        } while ((b & 0x80) != 0)  // has more data\r\n        if (!(b&0x40) || shift >= 32)\r\n            return num;\r\n        return (-1 << shift) + num;\r\n    }\r\n\r\n    readString() {\r\n        const len = this.readVLI()\r\n        const s = new TextDecoder().decode(this.buf.subarray(this.offset, this.offset + len))\r\n        this.offset += len\r\n        return s\r\n    }\r\n\r\n    readByte() {\r\n        return this.dv.getUint8(this.offset++)\r\n    }\r\n}\r\n\r\n","import { Decoder } from './decoder.ts'\r\n\r\nexport interface FlowerDesc {\r\n    id:number\r\n    path: string\r\n}\r\n\r\nclass Flowers {\r\n    get length() { return 12 }\r\n    getPath(idx:number) {\r\n        return `img/flower${idx + 1}.svg`\r\n    }\r\n\r\n    *items():Generator<FlowerDesc> {\r\n        const len = this.length\r\n        for (let i = 0; i < len; ++i) \r\n            yield {path: this.getPath(i), id: i}\r\n    }\r\n}\r\n\r\nconst flowers = new Flowers\r\nexport default flowers\r\n\r\nexport interface Action {\r\n    name:string\r\n    params:number[]\r\n}\r\n\r\nexport const actionTypes = [{name: \"delay\", numParams:1}, {name: \"resize\", numParams:2}, {name:\"lifetime\", numParams:1}]\r\n\r\nexport function actionEquals(a1:Action, a2:Action) {\r\n    if (a1.name != a2.name || a1.params.length != a2.params.length) return false\r\n    for (let idx = 0; idx < a1.params.length; ++idx)\r\n        if (a1.params[idx] != a2.params[idx]) return false\r\n    return true\r\n}\r\n\r\nexport function programEquals(p1:Action[], p2:Action[]) {\r\n    if (p1.length != p2.length) return false\r\n    for (let idx = 0; idx < p1.length; ++idx)\r\n        if (!actionEquals(p1[idx], p2[idx])) return false\r\n    return true\r\n}\r\n\r\n// configuration for a flower item to be displayed\r\nexport interface FlowerConfig {\r\n    id:number // id of flower img \r\n    x:number\r\n    y:number\r\n    size:number\r\n    rotate:number\r\n    program:Action[]\r\n}\r\n\r\nexport enum FlowerSettings {\r\n    HasRotate = 1 << 5,\r\n    HasActions = 1 << 6,\r\n    HasAnims = 1 << 7\r\n}\r\n\r\nexport function decodeGift(encoded:string) {\r\n    const decoder = new Decoder(encoded)\r\n    const version = decoder.readVLI()\r\n    const message = decoder.readString()\r\n    const signature = decoder.readString()\r\n    const year = decoder.readVLI()\r\n    const month = decoder.readVLI()\r\n    const day = decoder.readVLI()\r\n    const startDate = new Date(year, month, day)\r\n    \r\n    const numPrograms = decoder.readVLI()\r\n    const programs:Action[][] = []\r\n    for (let i = 0; i < numPrograms; ++i)\r\n        programs.push(decodeProgram(decoder))\r\n\r\n    const numFlowers = decoder.readVLI()\r\n    const flowers:FlowerConfig[] = []\r\n    for (let i = 0; i < numFlowers; ++i) {\r\n        const header = decoder.readByte()\r\n        const id = header & 0x1f\r\n        const x = decoder.readVLI()\r\n        const y = decoder.readVLI()\r\n        const size = decoder.readVLI()\r\n        const rotate = (header & FlowerSettings.HasRotate) ? decoder.readVLI() : 0\r\n        const program = (header & FlowerSettings.HasActions) ? programs[decoder.readVLI()] : []\r\n        flowers.push({id, x, y, size, rotate, program})\r\n    }\r\n    return {\r\n        message,\r\n        signature,\r\n        startDate, flowers\r\n    }\r\n}\r\n\r\nfunction decodeProgram(decoder:Decoder) {\r\n    const prog:Action[] = []\r\n    const len = decoder.readVLI()\r\n    for (let num = 0; num < len; ++num) {\r\n        const desc = decoder.readByte()\r\n        const typeIdx = desc >> 5\r\n        \r\n        const actType = actionTypes[typeIdx]\r\n        const action:Action = { name: actType.name, params:[] }\r\n        const firstParam = desc & 0x1F\r\n        let idx = 0\r\n        if (firstParam < 0x1F) {\r\n            action.params.push(firstParam)\r\n            idx = 1\r\n        }\r\n        for (; idx < actType.numParams; ++ idx)\r\n            action.params.push(decoder.readVLI())\r\n        prog.push(action)\r\n    }\r\n    return prog\r\n}\r\n\r\n\r\n\r\n(globalThis as any).decodeGift = decodeGift","export const el = document.createElement.bind(document)","import { el } from '../utils.ts'\r\nimport { FlowerConfig } from '../flowers.ts'\r\n\r\nexport class PropertyControls {\r\n    private properties = el(\"div\")\r\n    private flwConfig?:FlowerConfig\r\n    private props:{[key:string]:HTMLInputElement} = {}\r\n\r\n    get flowerConfig():FlowerConfig|undefined { return this.flwConfig }\r\n    set flowerConfig(flwConfig:FlowerConfig|undefined) {\r\n        this.flwConfig = flwConfig\r\n        if (flwConfig) {\r\n            this.props.size.value = flwConfig.size.toString()\r\n            this.props.rotate.value = flwConfig.rotate.toString()\r\n        }\r\n    }\r\n\r\n    get element() { return this.properties }\r\n\r\n    constructor() {\r\n        this.properties.classList.add(\"props\", \"grid\")\r\n        this.addNumericProperty(\"size\", val => {\r\n            if (this.flowerConfig) this.flowerConfig.size = val\r\n        })\r\n        this.addNumericProperty(\"rotate\", val => {\r\n            if (this.flowerConfig) this.flowerConfig.rotate = val\r\n        })\r\n    }\r\n\r\n    addNumericProperty(name:string, onChange:(val:number)=>void) {\r\n        const input = el(\"input\")\r\n        input.id = `prop-${name}`\r\n        input.value = \"10\"\r\n        const label = el(\"label\")\r\n        label.htmlFor = input.id\r\n        label.innerText = name\r\n        this.properties.append(label, input)\r\n        input.oninput = evt => { \r\n            if (input.value.length > 0)\r\n                onChange(Number.parseInt(input.value))\r\n        }\r\n        // add event listener to keyUp and keyDown (which will increase or decrease the props value, like css inspector)\r\n        //       holding control will increase it with 10\r\n        const direction:any = { ArrowUp: 1, ArrowDown:-1}\r\n        input.onkeydown = evt => {\r\n            const dir:number = direction[evt.key]\r\n            if (!dir) \r\n                return\r\n            let val = Number.parseInt(input.value)\r\n            val += dir * (evt.ctrlKey ? 10 : 1)\r\n            input.value = val.toString()\r\n            input.select()\r\n            onChange(val) // setting input value doesn't trigger oninput event\r\n            \r\n            evt.preventDefault()\r\n            evt.stopPropagation()\r\n        }\r\n        this.props[name] = input\r\n    }\r\n}","import { Action } from \"../flowers.ts\"\r\n\r\n// utility methods for parsing\r\nfunction inList(char:string, charList:string) {\r\n    return char.length == 1 && charList.indexOf(char) >= 0\r\n}\r\n\r\nfunction inRange(char:string, start:string, end:string) {\r\n    return char >= start && char <= end\r\n}\r\n\r\nclass Lexer {\r\n    offs = 0;\r\n    constructor(public s:string) {\r\n\r\n    }\r\n\r\n    get eof() { return this.offs >= this.s.length }\r\n    get current():string|undefined { return this.s[this.offs] }\r\n    next() { if (!this.eof) ++this.offs; return this.current }\r\n\r\n    parseId() {\r\n        const start = this.offs;\r\n        let c = this.current;\r\n        if (c && (inRange(c, 'a', 'z') || inRange(c, 'A', 'Z') || inList(c, \"_$\"))) {\r\n            c = this.next();\r\n            for (; c; c = this.next()) {\r\n                if (!inRange(c, 'a', 'z') && !inRange(c, 'A', 'Z') && !inList(c, \"_$\") && !inRange(c, '0', '9'))\r\n                    break;\r\n            }\r\n        }\r\n        if (this.offs > start) return this.s.substring(start, this.offs)\r\n        else return undefined\r\n    }\r\n\r\n    isIdChar(c:string|undefined=undefined) {\r\n        if (c==undefined)\r\n            c= this.current;\r\n        return c ? inRange(c, 'a', 'z') || inRange(c, 'A', 'Z') || inList(c, \"_$\") || inRange(c, '0', '9') : false;\r\n    }\r\n\r\n\tparseString() {\r\n\t\tconst start = this.offs + 1;\r\n        let delimiter = this.current!;\r\n\t\tif (!inList(delimiter, `\"'`)) return undefined\r\n\t\tlet prev = delimiter\r\n\t\tfor (let c = this.next(); c; c = this.next()) {\r\n\t\t\tif (c == delimiter && prev != \"\\\\\") { // finished\r\n\t\t\t\tlet s = this.s.substring(start, this.offs).replace(\"\\\\\" + delimiter, delimiter)\r\n\t\t\t\tthis.next()\r\n\t\t\t\treturn s\r\n\t\t\t}\r\n\t\t\tprev = c;\r\n\t\t}\r\n\t\tthis.offs = start - 1\r\n\t\treturn undefined\r\n\t}\r\n\r\n\tparseInt() {\r\n        const start = this.offs;\r\n        let c = this.current;\r\n        if (c && inRange(c, '0', '9')) {\r\n            c = this.next();\r\n            for (; c; c = this.next()) {\r\n                if (!inRange(c, '0', '9'))\r\n                    break;\r\n            }\r\n        }\r\n        if (this.offs > start) return Number.parseInt(this.s.substring(start, this.offs))\r\n        else return undefined\r\n    }\r\n\r\n    skipWs() {\r\n        this.skipSpaces()\r\n        if (this.skipComment())\r\n            this.skipSpaces()\r\n    }\r\n\r\n    private skipSpaces() {\r\n        for (let c = this.current; c; c = this.next())  {\r\n            if (!inList(c, \" \\t\\r\\n\")) break;\r\n        }\r\n    }\r\n\r\n    private skipComment() {\r\n        if (!this.match(\"//\")) \r\n            return false\r\n        const eol = this.s.indexOf(\"\\n\", this.offs)\r\n        this.offs = eol == -1 ? this.s.length : eol + 1\r\n        return true\r\n    }\r\n\r\n    match(s:string) {\r\n        if (this.s.startsWith(s, this.offs)) {\r\n            this.offs += s.length;\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    matchAnyChar(s:string) {\r\n        let c = this.current;\r\n        if (!c || !inList(c, s))\r\n            return undefined;\r\n        this.offs += 1;\r\n        return c;\r\n    }\r\n\r\n    matchAndSkipWs(s:string) {\r\n        const matched = this.match(s)\r\n        if (matched) this.skipWs()\r\n        return matched\r\n    }\r\n}\r\n\r\n// map from action name to number of params\r\nconst validActions = new Map([[\"delay\", 1], [\"resize\", 2], [\"lifetime\", 1]])\r\n\r\nfunction compileError(message:string, lexer:Lexer) {\r\n    // todo: seek back to the beginning of the current line, display\r\n    //        current line, but insert a ^ char at the location of the error\r\n    return new Error(`${message} around '${lexer.s.substring(lexer.offs - 10, lexer.offs + 10)}'`)\r\n}\r\n\r\nexport function compile(program:string) {\r\n    const lexer = new Lexer(program)\r\n    const errors:Error[] = []\r\n    const actions:Action[] = []\r\n    lexer.skipWs()\r\n    while (!lexer.eof) {\r\n        const id = lexer.parseId()\r\n        if (!id) {\r\n            errors.push(compileError(\"Expected an action\", lexer))\r\n            break;\r\n        }\r\n        const valid = validActions.has(id)\r\n        if (!valid) {\r\n            errors.push(compileError(`Unknown action ${id}`, lexer))\r\n        }\r\n        lexer.skipWs()\r\n        if (!lexer.matchAndSkipWs('(')) {\r\n            errors.push(compileError(\"Expected `(`\", lexer))\r\n            break;\r\n        }\r\n        // read params\r\n        const params:number[] = []\r\n        let paramError = false \r\n        while (!lexer.eof && !paramError) {\r\n            if (lexer.match(')'))\r\n                break; // finished params\r\n            const p = lexer.parseInt()\r\n            if (!p) {\r\n                paramError = true\r\n                errors.push(compileError(\"Expected a numeric parameter\", lexer));\r\n                break;\r\n            }\r\n            params.push(p)\r\n            lexer.skipWs()\r\n\r\n            if (lexer.match(')'))\r\n                break; // finished params\r\n            \r\n            if (!lexer.matchAndSkipWs(',')) {\r\n                paramError = true\r\n                errors.push(compileError(\"Expected `,` or `)`\", lexer));\r\n            }\r\n        }\r\n        if (paramError) \r\n            break;\r\n        \r\n        if (valid) {\r\n            const requiredParams = validActions.get(id)!\r\n            if (requiredParams == params.length)\r\n                actions.push({name: id, params})\r\n            else errors.push(compileError(`${id} requires ${requiredParams}. Got: ${params.length}`, lexer))\r\n        }\r\n        lexer.skipWs()\r\n    }\r\n\r\n    return { actions, errors }\r\n}","import {\r\n    encode as encodeBase64,\r\n  } from \"https://deno.land/std@0.97.0/encoding/base64.ts\";\r\n\r\nexport class Encoder {\r\n    private buf = new Uint8Array(4096)\r\n    private dv:DataView = new DataView(this.buf.buffer)\r\n    private offs = 0\r\n\r\n    /**\r\n     * Write num as a signed variable length integer\r\n     * // see: https://en.wikipedia.org/wiki/LEB128\r\n     */\r\n    writeVLI(num:number) {\r\n        num = Math.round(num) // convert to integer\r\n        // >>> is unsigned shift right in javascript, thus converts number to unsigned\r\n        let part = (num >>> 0) & 0x7F;\r\n        num = num >> 7;\r\n        while (num != ((part & 0x40) ? -1 : 0)) {\r\n            this.writeByte(part | 0x80);\r\n             \r\n            part = (num >>> 0) & 0x7F\r\n            num = num >> 7;\r\n        }\r\n        this.writeByte(part);\r\n    }\r\n\r\n    writeString(s:string) {\r\n        const utf8Stream = new TextEncoder().encode(s)\r\n        this.writeVLI(utf8Stream.byteLength)\r\n        this.buf.set(utf8Stream, this.incOffset(utf8Stream.byteLength)) \r\n    }\r\n\r\n    encode() {\r\n        const changes:any = { \"+\": \"-\", \"/\": \"_\", \"=\": \".\" } // replaces some base64 chars to urlencode safe chars \r\n        return encodeBase64(this.buf.subarray(0, this.offs)).replace(/\\+|\\/|\\=/g, match=> changes[match])\r\n    }\r\n\r\n    private incOffset(size:number) {\r\n        const old = this.offs\r\n        this.offs += size;\r\n        return old\r\n    }\r\n    \r\n    writeByte(val:number) {\r\n        this.dv.setUint8(this.incOffset(1), val)\r\n    }    \r\n}\r\n\r\n\r\n","import flowerPaths from './flowers.ts'\r\nimport { FlowerDesc, FlowerConfig, Action, programEquals, actionTypes, FlowerSettings } from './flowers.ts'\r\nimport { PropertyControls } from './editor/propertyControls.ts'\r\nimport { el } from './utils.ts'\r\nimport { compile as compileActions } from './editor/actionCompiler.ts'\r\nimport { Encoder } from './encoder.ts'\r\n\r\nwindow.onload = ()=> {\r\n    const sideBar = document.body.querySelector(\"#side\") as HTMLElement\r\n    editor.displayControls(sideBar)\r\n    projectSettings.displayControls(sideBar)\r\n    editor.canvas = document.body.querySelector(\"#canvas\")!\r\n\r\n    const proj = loadProject(\"1\") // currently proj with id of 1 is burnt in\\\r\n    if (!proj)\r\n        return\r\n    projectSettings.name = proj.name\r\n    projectSettings.startDate = new Date(proj.startDate)\r\n    projectSettings.message = proj.message\r\n    projectSettings.signature = proj.signature\r\n    for (const f of proj.flowers) {\r\n        editor.addSaved(f)\r\n    }\r\n}\r\n\r\nfunction flowerIcon(flower:FlowerDesc):HTMLElement {\r\n    const icon = el(\"div\")\r\n    icon.classList.add(\"flower\", \"icon\")\r\n    const img = el(\"img\")\r\n    img.src = flower.path\r\n    icon.appendChild(img)\r\n\r\n    icon.ondblclick = () => {\r\n        editor.addFlower(flower)\r\n    }\r\n    return icon\r\n}\r\n\r\nfunction sectionHeader(text:string) {\r\n    const header = el(\"div\")\r\n    header.classList.add(\"header\")\r\n    header.innerText = text\r\n    return header\r\n}\r\n\r\nclass Editor {\r\n    canvas:HTMLElement = el('div')\r\n    items:FlowerItem[] = []\r\n    propertyControls = new PropertyControls\r\n    private selectedFlower?:FlowerItem \r\n    // associated program with given flower\r\n    private program = el(\"textarea\")\r\n\r\n    displayControls(parent:HTMLElement) {\r\n        const flowerSelection = el(\"div\")\r\n        parent.appendChild(flowerSelection)\r\n        flowerSelection.classList.add(\"flowers\", \"grid\")\r\n        for (const flower of flowerPaths.items()) \r\n            flowerSelection.appendChild(flowerIcon(flower))\r\n        \r\n        parent.append(sectionHeader(\"Properties\"))\r\n        parent.appendChild(this.propertyControls.element)\r\n\r\n        parent.appendChild(sectionHeader(\"Program\"))\r\n        parent.appendChild(this.program)\r\n\r\n        this.program.classList.add(\"program\")\r\n        this.program.rows = 3\r\n        this.program.oninput = () => {\r\n            const res = this.validateProgram()\r\n            if (this.selectedFlower) {\r\n                this.selectedFlower.programText = this.program.value\r\n                this.selectedFlower.program = res.actions\r\n            }\r\n        }\r\n\r\n        document.body.onkeydown = evt => {\r\n            if (evt.target != document.body)\r\n                return\r\n            if (evt.key == \"Delete\" && this.selectedFlower) {\r\n                this.selectedFlower.element.remove()\r\n                const idx = this.items.indexOf(this.selectedFlower)\r\n                this.items.splice(idx, 1)\r\n            }\r\n        }\r\n    }\r\n    \r\n\r\n    addFlower(f:FlowerDesc) {\r\n        const canvasRect = this.canvas.getBoundingClientRect()\r\n        const size = canvasRect.width * 15 / 100\r\n\r\n        const flower = new FlowerItem(f, {size, x: (canvasRect.width)/2, y: (canvasRect.height)/ 2})\r\n        this.canvas.appendChild(flower.element)\r\n        this.items.push(flower)\r\n\r\n        flower.ongrabbed = () => {\r\n            this.select(flower)\r\n        }\r\n\r\n        this.select(flower)\r\n    }\r\n\r\n    addSaved(f:SavedFlower) {\r\n        const flower = new FlowerItem({id:f.id, path:flowerPaths.getPath(f.id)}, {size:f.size, x: f.x, y: f.y})\r\n        flower.rotate = f.rotate\r\n        flower.programText = f.programText\r\n\r\n        this.canvas.appendChild(flower.element)\r\n        this.items.push(flower)\r\n\r\n        flower.ongrabbed = () => {\r\n            this.select(flower)\r\n        }\r\n    }\r\n\r\n    private select(flowerItem?:FlowerItem) {\r\n        if (this.selectedFlower == flowerItem)\r\n            return\r\n        if (this.selectedFlower)\r\n            this.selectedFlower.selected = false\r\n        this.selectedFlower = flowerItem\r\n        if (flowerItem)\r\n            flowerItem.selected = true\r\n        this.propertyControls.flowerConfig = flowerItem\r\n        this.program.value = flowerItem?.programText ?? \"\"\r\n        this.validateProgram()\r\n    }\r\n\r\n    private validateProgram() {\r\n        // can validate the current program with the given error message\r\n        // using setCustomValidity, ex:\r\n        const res = compileActions(this.program.value)\r\n        if (res.errors.length)\r\n            this.program.setCustomValidity(res.errors.join(\"\\n\"))\r\n        else this.program.setCustomValidity(\"\")\r\n        return res\r\n    }\r\n}\r\n\r\nclass FlowerItem implements FlowerConfig {\r\n    element:HTMLElement\r\n    private pos = {x: 0, y: 0}\r\n    private props = {size: 0, rotate: 0}\r\n    programText:string = \"\"\r\n    program:Action[] = []\r\n\r\n    id:number\r\n    get x() { return this.pos.x }\r\n    get y() { return this.pos.y }\r\n    get size() { return this.props.size }\r\n    get rotate() { return this.props.rotate }\r\n\r\n    ongrabbed?:()=>void \r\n\r\n    constructor(f:FlowerDesc, options: {size: number, x:number, y:number}) {\r\n        this.id = f.id\r\n        this.element = el(\"div\")\r\n        this.element.classList.add(\"flower\", \"item\")\r\n        const style = this.element.style\r\n        style.position = \"absolute\"\r\n        this.x = options.x\r\n        this.y = options.y\r\n        this.size = options.size\r\n        const img = el(\"img\")\r\n        img.draggable = false\r\n        img.src = f.path\r\n        this.element.appendChild(img)\r\n\r\n        this.installHandlers()\r\n    }\r\n\r\n    get selected() { return this.element.classList.contains(\"selected\") }\r\n    set selected(sel:boolean) {\r\n        if (sel) this.element.classList.add(\"selected\")\r\n        else  this.element.classList.remove(\"selected\")\r\n    }\r\n\r\n    set x(x:number) { \r\n        this.pos.x = x\r\n        this.element.style.left = `${x - this.size / 2}px`\r\n     }\r\n    set y(y:number) { \r\n        this.pos.y = y\r\n        this.element.style.top = `${y  - this.size / 2}px`\r\n    }\r\n    set size(size:number) { \r\n        const oldSize = this.props.size\r\n        const diff = size - oldSize\r\n        if (diff == 0) return\r\n        this.props.size = size\r\n        this.element.style.width = `${size}px`\r\n        // update pos, based on size change (center pos always)\r\n        this.element.style.left = `${this.x - size / 2}px`\r\n        this.element.style.top = `${this.y  - size / 2}px`\r\n    }\r\n\r\n    set rotate(rotate:number) {\r\n        this.props.rotate = rotate\r\n        this.element.style.transform =`rotate(${rotate}deg)`\r\n    }\r\n\r\n    private installHandlers() {\r\n        // see: https://developer.mozilla.org/en-US/docs/Web/API/Element/setPointerCapture\r\n        // about pointerCapture\r\n        let startPos = {x: 0, y: 0}\r\n        let start = { x: 0, y: 0}\r\n        const slide = (e:PointerEvent)=> {\r\n            this.x = start.x + e.clientX - startPos.x\r\n            this.y = start.y + e.clientY - startPos.y\r\n        }\r\n\r\n        this.element.onpointerdown = (e) => {\r\n            this.ongrabbed?.()\r\n            this.element.onpointermove = slide\r\n            this.element.setPointerCapture(e.pointerId)\r\n            startPos.x = e.clientX\r\n            startPos.y = e.clientY\r\n            \r\n            start = { x : this.x, y: this.y}\r\n        }\r\n\r\n        this.element.onpointerup = (e) => {\r\n            this.element.releasePointerCapture(e.pointerId)\r\n            this.element.onpointermove = null\r\n        }\r\n    }\r\n}\r\n\r\nconst editor = new Editor()\r\n\r\nclass ProjectSettings {\r\n    private startDateVal = new Date()\r\n    private nameVal:string = \"\" // todo: could use simply the value of nameInput in the getter\r\n    private nameInput:HTMLInputElement\r\n    private dateInput:HTMLInputElement\r\n    private container = el(\"div\")\r\n    private messageInput = el(\"textarea\")\r\n    private signatureInput = el(\"textarea\")\r\n\r\n    constructor() {\r\n        const container = this.container\r\n        container.classList.add(\"settings\", \"props\", \"grid\")\r\n        const dateInput = this.addSetting(\"Start date\")\r\n        dateInput.type = \"date\"\r\n        dateInput.valueAsDate = this.startDateVal\r\n        dateInput.oninput = () => {\r\n            const newDate = dateInput.valueAsDate\r\n            if (newDate)\r\n                this.startDateVal = newDate\r\n        }\r\n        this.dateInput = dateInput\r\n\r\n        const nameInput = this.addSetting(\"Name\")\r\n        nameInput.value = this.nameVal\r\n        nameInput.oninput = () => {\r\n            this.nameVal = nameInput.value\r\n        }\r\n        this.nameInput = nameInput\r\n\r\n        this.addNamedInput(this.messageInput, \"Message\")\r\n        this.addNamedInput(this.signatureInput, \"Signature\")\r\n\r\n        const saveBtn = el(\"button\")\r\n        saveBtn.id = \"save\"\r\n        saveBtn.innerText = \"Save\"\r\n        saveBtn.onclick = ()=> {\r\n            saveProject(\"1\") // currently the burnt in id of 1 is used\r\n            console.log(\"Encoded: \", encodeProject())\r\n        }\r\n        container.append(saveBtn)\r\n    }\r\n\r\n    displayControls(parent:HTMLElement) {\r\n        parent.appendChild(sectionHeader(\"Settings\"))\r\n        parent.append(this.container)\r\n    }\r\n    \r\n    private addSetting(name:string) {\r\n        const input = el(\"input\")\r\n        input.id = `setting-${name}`\r\n        const label = el(\"label\")\r\n        label.htmlFor = input.id\r\n        label.innerText = name\r\n        this.container.append(label, input)\r\n        return input\r\n    }\r\n\r\n    private addNamedInput(input:HTMLInputElement|HTMLTextAreaElement, name:string) {\r\n        input.id = `setting-${name}`\r\n        const label = el(\"label\")\r\n        label.htmlFor = input.id\r\n        label.innerText = name\r\n        this.container.append(label, input)\r\n    }\r\n\r\n    get name() { return this.nameVal }\r\n    get startDate() { return this.dateInput.valueAsDate ?? new Date() }\r\n\r\n    set name(name:string) { \r\n        this.nameVal = name\r\n        this.nameInput.value = name\r\n    }\r\n\r\n    set startDate(date:Date) {\r\n        this.startDateVal = date\r\n        this.dateInput.valueAsDate = date\r\n    }\r\n\r\n    get message() { return this.messageInput.value }\r\n    set message(msg:string) { this.messageInput.value = msg }\r\n    get signature() { return this.signatureInput.value }\r\n    set signature(sign:string) { this.signatureInput.value = sign }\r\n}\r\n\r\nconst projectSettings = new ProjectSettings\r\n\r\ninterface SavedFlower extends FlowerConfig {\r\n    programText:string\r\n}\r\n\r\nfunction saveProject(id:string) {\r\n    const proj = {\r\n        startDate : projectSettings.startDate,\r\n        name: projectSettings.name,\r\n        message:projectSettings.message,\r\n        signature:projectSettings.signature,\r\n        flowers: [] as SavedFlower[]\r\n    }\r\n\r\n    for (const f of editor.items) {\r\n        proj.flowers.push({\r\n            id: f.id,\r\n            x: f.x,\r\n            y: f.y,\r\n            size: f.size,\r\n            rotate: f.rotate,\r\n            program: [],\r\n            programText: f.programText\r\n        })\r\n    }\r\n\r\n    localStorage.setItem(id, JSON.stringify(proj))\r\n}\r\n\r\nfunction loadProject(id:string) {\r\n    const data = localStorage.getItem(id)\r\n    if (!data)\r\n        return undefined\r\n    const parsed = JSON.parse(data) as { startDate:string, name:string, flowers: SavedFlower[], message:string, signature:string }\r\n    if (!parsed.message) parsed.message = \"\"\r\n    if (!parsed.signature) parsed.signature = \"\"\r\n    return parsed\r\n}\r\n\r\n\r\n/**\r\n * Encodes current project as a base64 string\r\n */\r\nfunction encodeProject() {\r\n    const enc = new Encoder()\r\n    const VERSION = 0\r\n    enc.writeVLI(VERSION)\r\n    enc.writeString(projectSettings.message)\r\n    enc.writeString(projectSettings.signature)\r\n    enc.writeVLI(projectSettings.startDate.getFullYear())\r\n    enc.writeVLI(projectSettings.startDate.getMonth())\r\n    enc.writeVLI(projectSettings.startDate.getDate())\r\n\r\n    const programSet = gatherPrograms(editor.items)\r\n    // fill in programs, these will be indexed by individual flowers\r\n    enc.writeVLI(programSet.programs.length)\r\n    for (const prog of programSet.programs) {\r\n        enc.writeVLI(prog.length)\r\n        for (const a of prog) \r\n            encodeAction(enc, a)\r\n    }\r\n\r\n    enc.writeVLI(editor.items.length)\r\n    editor.items.forEach( (f, idx) => {\r\n        let header = f.id\r\n        // encode other flower settings in this byte\r\n        if (f.rotate != 0) \r\n            header = header | FlowerSettings.HasRotate\r\n        const progIdx = programSet.progIdxs[idx]\r\n        if (progIdx >= 0)\r\n            header = header | FlowerSettings.HasActions\r\n        enc.writeByte(header)\r\n        enc.writeVLI(f.x)\r\n        enc.writeVLI(f.y)\r\n        enc.writeVLI(f.size)\r\n        if (f.rotate != 0)\r\n            enc.writeVLI(f.rotate)\r\n        if (progIdx >= 0)\r\n            enc.writeVLI(progIdx)\r\n    })\r\n    return enc.encode()\r\n}\r\n\r\nfunction encodeAction(enc:Encoder, a:Action) {\r\n    const typeIdx = actionTypes.findIndex(t => t.name == a.name)\r\n    // action indices encoded on 3 bits, we try to fit first param (which is usually number of days) on this byte too\r\n    let descriptor = typeIdx << 5 // action type on the top 3 bit\r\n    const firstParam = a.params[0]\r\n    const firstParamIncluded = firstParam >= 0 && firstParam < 31\r\n    if (firstParamIncluded)\r\n        descriptor = descriptor | firstParam\r\n    else descriptor = descriptor | 31\r\n    enc.writeByte(descriptor)\r\n    for (let pidx = firstParamIncluded ? 1 : 0; pidx < a.params.length; ++pidx) {\r\n        enc.writeVLI(a.params[pidx])\r\n    }\r\n}\r\n\r\n/**\r\n * Gather unique programs for the set of items\r\n * @returns the list of unique programs, and the selected program for each item (progIdxs). -1 means that the flower has no associated program\r\n */\r\nfunction gatherPrograms(items:FlowerItem[]) {\r\n    const programs:(Action[])[] = []\r\n    // index of program for each flower, -1 means that no program or empty program is associated\r\n    const progIdxs:number[] = []\r\n\r\n    for (const f of items) {\r\n        const prog = f.program\r\n        if (prog.length == 0) {\r\n            progIdxs.push(-1) // empty\r\n            continue\r\n        }\r\n        // get program index, or add to list of programs if not yet used\r\n        let idx = -1\r\n        for (let pidx = programs.length - 1; pidx >= 0; --pidx) {\r\n            if (programEquals(prog, programs[pidx])) {\r\n                idx = pidx\r\n                break;\r\n            }\r\n        }\r\n        if (idx == -1) { // the same program hasn't been found\r\n            idx = programs.length\r\n            programs.push(prog)\r\n        }\r\n        progIdxs.push(idx)\r\n    }\r\n    return { programs, progIdxs }\r\n}"],"names":[],"mappings":"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"}